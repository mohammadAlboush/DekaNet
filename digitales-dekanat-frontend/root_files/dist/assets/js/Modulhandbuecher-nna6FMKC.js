import{j as e,B as j,z as re,N as F,H as _,x as ne,f as s,P as I,a7 as se,a8 as $,aA as B,a0 as z,a1 as W,O as ae,Q as ie,aL as le,aw as D,ax as E,az as J,o as l,ab as g,ae as oe,af as ce,ag as de,ah as O,aj as he,ai as h,bJ as ue}from"./vendor-mui-BiVZR0IW.js";import{r as c}from"./vendor-react-CBtCGaWm.js";import{a as xe}from"./dashboardService-CkSNEkau.js";import"./index-BXi_OX1m.js";import"./vendor-utils-DTv3oRQQ.js";function U(i){const{children:a,value:v,index:m,...S}=i;return e.jsx("div",{role:"tabpanel",hidden:v!==m,...S,children:v===m&&e.jsx(j,{sx:{py:2},children:a})})}const Z={pflicht:"success",wahlpflicht:"warning",wahlbereich:"info",projekt:"secondary",thesis:"error"},M={pflicht:"Pflicht",wahlpflicht:"Wahlpflicht",wahlbereich:"Wahlbereich",projekt:"Projekt",thesis:"Thesis",unbekannt:"Unbekannt"};function L(i){if(!i)return"Unbekannt";const a=i.toLowerCase();return a.includes("wintersemester")&&a.includes("sommersemester")||a.includes("jedes semester")?"Jedes Semester":a.includes("wintersemester")||a.includes("winter")?"Wintersemester":a.includes("sommersemester")||a.includes("sommer")?"Sommersemester":a.includes("unregelmäßig")||a.includes("unregelm")||a.includes("bedarf")?"Bei Bedarf":i}function ge(i){const a=L(i);return a==="Wintersemester"?"info":a==="Sommersemester"?"warning":a==="Jedes Semester"?"success":a==="Bei Bedarf"?"secondary":"default"}const ve=()=>{const[i,a]=c.useState(null),[v,m]=c.useState(!0),[S,H]=c.useState(null),[C,Q]=c.useState(0),[k,R]=c.useState(""),[w,N]=c.useState("alle"),[y,V]=c.useState("alle"),[x,q]=c.useState("kuerzel"),[T,P]=c.useState("asc");c.useEffect(()=>{(async()=>{try{m(!0);const r=await xe();r.data&&a(r.data)}catch(r){H("Fehler beim Laden der Modulhandbücher."),console.error(r)}finally{m(!1)}})()},[]);const G=t=>{x===t?P(r=>r==="asc"?"desc":"asc"):(q(t),P("asc"))},X=c.useMemo(()=>t=>{let r=t;if(k.trim()){const o=k.toLowerCase();r=r.filter(d=>d.kuerzel.toLowerCase().includes(o)||d.bezeichnung_de.toLowerCase().includes(o)||d.verantwortlicher&&d.verantwortlicher.toLowerCase().includes(o)||d.kategorie&&M[d.kategorie]?.toLowerCase().includes(o))}return w!=="alle"&&(r=r.filter(o=>(o.kategorie||"unbekannt")===w)),y!=="alle"&&(r=r.filter(o=>L(o.turnus)===y)),[...r].sort((o,d)=>{const A=T==="asc"?1:-1,p=o[x],f=d[x];return p==null&&f==null?0:p==null?1:f==null?-1:typeof p=="number"&&typeof f=="number"?(p-f)*A:String(p).localeCompare(String(f),"de")*A})},[k,w,y,x,T]);if(v)return e.jsx(j,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:e.jsx(re,{})});if(S||!i)return e.jsx(F,{maxWidth:"lg",sx:{mt:2},children:e.jsx(_,{severity:"error",children:S||"Keine Daten verfügbar."})});const b=i.nicht_zugeordnet?.module||[],Y=()=>e.jsxs(B,{direction:"row",spacing:2,sx:{mb:3,flexWrap:"wrap",gap:1},children:[e.jsx(z,{sx:{minWidth:140},children:e.jsxs(W,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Module gesamt"}),e.jsx(s,{variant:"h5",fontWeight:600,children:i.gesamt_statistik.alle_module})]})}),e.jsx(z,{sx:{minWidth:140},children:e.jsxs(W,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Zugeordnet"}),e.jsx(s,{variant:"h5",fontWeight:600,color:"success.main",children:i.gesamt_statistik.zugeordnet})]})}),i.gesamt_statistik.nicht_zugeordnet>0&&e.jsx(z,{sx:{minWidth:140},children:e.jsxs(W,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Ohne Zuordnung"}),e.jsx(s,{variant:"h5",fontWeight:600,color:"warning.main",children:i.gesamt_statistik.nicht_zugeordnet})]})}),e.jsx(z,{sx:{minWidth:140},children:e.jsxs(W,{sx:{py:1.5,"&:last-child":{pb:1.5}},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Studiengänge"}),e.jsx(s,{variant:"h5",fontWeight:600,children:i.gesamt_statistik.studiengaenge})]})})]}),ee=t=>e.jsxs(B,{direction:"row",spacing:1,sx:{mb:2,flexWrap:"wrap",gap:.5},children:[e.jsx(g,{label:`${t.statistik.anzahl_module} Module`,size:"small"}),e.jsx(g,{label:`${t.statistik.ects_summe} ECTS`,size:"small",variant:"outlined"}),Object.entries(t.statistik.kategorien).map(([r,n])=>e.jsx(g,{label:`${M[r]||r}: ${n}`,size:"small",color:Z[r]||"default",variant:"outlined"},r)),t.statistik.turnus_verteilung&&Object.entries(t.statistik.turnus_verteilung).filter(([r])=>r!=="unbekannt").map(([r,n])=>{const o={wintersemester:"WS",sommersemester:"SS",jedes_semester:"WS+SS",sonstige:"Sonstige"};return e.jsx(g,{label:`${o[r]||r}: ${n}`,size:"small",variant:"outlined",color:r==="wintersemester"?"info":r==="sommersemester"?"warning":r==="jedes_semester"?"success":"default"},`turnus-${r}`)})]}),te=()=>e.jsxs(B,{direction:"row",spacing:2,sx:{mb:2,flexWrap:"wrap",gap:1,alignItems:"center"},children:[e.jsx(ae,{size:"small",placeholder:"Module suchen (Kürzel, Name, Verantwortlicher...)",value:k,onChange:t=>R(t.target.value),sx:{width:350},InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(le,{})})}}),e.jsxs(D,{size:"small",sx:{minWidth:160},children:[e.jsx(E,{children:"Kategorie"}),e.jsxs(J,{value:w,label:"Kategorie",onChange:t=>N(t.target.value),children:[e.jsx(l,{value:"alle",children:"Alle Kategorien"}),e.jsx(l,{value:"pflicht",children:"Pflicht"}),e.jsx(l,{value:"wahlpflicht",children:"Wahlpflicht"}),e.jsx(l,{value:"wahlbereich",children:"Wahlbereich"}),e.jsx(l,{value:"projekt",children:"Projekt"}),e.jsx(l,{value:"thesis",children:"Thesis"}),e.jsx(l,{value:"unbekannt",children:"Unbekannt"})]})]}),e.jsxs(D,{size:"small",sx:{minWidth:180},children:[e.jsx(E,{children:"Turnus"}),e.jsxs(J,{value:y,label:"Turnus",onChange:t=>V(t.target.value),children:[e.jsx(l,{value:"alle",children:"Alle Turnus"}),e.jsx(l,{value:"Wintersemester",children:"Wintersemester"}),e.jsx(l,{value:"Sommersemester",children:"Sommersemester"}),e.jsx(l,{value:"Jedes Semester",children:"Jedes Semester"}),e.jsx(l,{value:"Bei Bedarf",children:"Bei Bedarf"}),e.jsx(l,{value:"Unbekannt",children:"Unbekannt"})]})]})]}),u=(t,r,n)=>e.jsx(h,{align:n,sx:{fontWeight:600},children:e.jsx(ue,{active:x===t,direction:x===t?T:"asc",onClick:()=>G(t),children:r})}),K=t=>{const r=X(t);return r.length===0?e.jsx(_,{severity:"info",sx:{mt:1},children:"Keine Module gefunden."}):e.jsxs(e.Fragment,{children:[e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[r.length," von ",t.length," Module",r.length!==t.length?" (gefiltert)":""]}),e.jsx(oe,{component:I,variant:"outlined",children:e.jsxs(ce,{size:"small",children:[e.jsx(de,{children:e.jsxs(O,{children:[u("kuerzel","Kürzel"),u("bezeichnung_de","Bezeichnung"),u("leistungspunkte","LP","center"),u("sws_gesamt","SWS","center"),u("semester","Sem.","center"),u("kategorie","Kategorie"),u("turnus","Turnus"),u("verantwortlicher","Verantwortlich")]})}),e.jsx(he,{children:r.map(n=>e.jsxs(O,{hover:!0,children:[e.jsx(h,{children:e.jsx(s,{variant:"body2",fontWeight:600,children:n.kuerzel})}),e.jsxs(h,{children:[e.jsx(s,{variant:"body2",children:n.bezeichnung_de}),n.bezeichnung_en&&e.jsx(s,{variant:"caption",color:"text.secondary",children:n.bezeichnung_en})]}),e.jsx(h,{align:"center",children:n.leistungspunkte||"–"}),e.jsx(h,{align:"center",children:n.sws_gesamt||"–"}),e.jsx(h,{align:"center",children:n.semester||"–"}),e.jsx(h,{children:n.kategorie?e.jsx(g,{label:M[n.kategorie]||n.kategorie,size:"small",color:Z[n.kategorie]||"default"}):e.jsx(s,{variant:"caption",color:"text.secondary",children:"–"})}),e.jsx(h,{children:n.turnus?e.jsx(g,{label:L(n.turnus),size:"small",color:ge(n.turnus),variant:"outlined"}):e.jsx(s,{variant:"caption",color:"text.secondary",children:"–"})}),e.jsxs(h,{children:[e.jsx(s,{variant:"body2",children:n.verantwortlicher||"–"}),n.lehrpersonen&&n.lehrpersonen.length>0&&e.jsxs(s,{variant:"caption",color:"text.secondary",display:"block",children:["+ ",n.lehrpersonen.join(", ")]})]})]},n.id))})]})})]})};return e.jsxs(F,{maxWidth:"xl",sx:{mt:1},children:[e.jsxs(j,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(ne,{color:"primary"}),e.jsx(s,{variant:"h5",fontWeight:600,children:"Modulhandbücher"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:1},children:"PO 2023"})]}),Y(),te(),e.jsxs(I,{sx:{width:"100%"},children:[e.jsxs(se,{value:C,onChange:(t,r)=>Q(r),variant:"scrollable",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider"},children:[i.studiengaenge.map(t=>e.jsx($,{label:e.jsxs(j,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"body2",fontWeight:600,children:t.kuerzel}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[t.abschluss," (",t.statistik.anzahl_module,")"]})]})},t.id)),b.length>0&&e.jsx($,{label:`Ohne Zuordnung (${b.length})`})]}),i.studiengaenge.map((t,r)=>e.jsx(U,{value:C,index:r,children:e.jsxs(j,{sx:{px:2},children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,children:[t.bezeichnung," (",t.kuerzel,")",t.abschluss&&e.jsxs(s,{component:"span",variant:"body2",color:"text.secondary",children:[" – ",t.abschluss]})]}),t.ects_gesamt&&e.jsxs(s,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Regelstudienzeit: ",t.regelstudienzeit||"–"," Semester | ",t.ects_gesamt," ECTS"]}),ee(t),K(t.module)]})},t.id)),b.length>0&&e.jsx(U,{value:C,index:i.studiengaenge.length,children:e.jsxs(j,{sx:{px:2},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Module ohne Studiengang-Zuordnung"}),e.jsxs(_,{severity:"warning",sx:{mb:2},children:["Diese ",b.length," Module sind keinem Studiengang zugeordnet."]}),K(b)]})})]})]})};export{ve as default};
