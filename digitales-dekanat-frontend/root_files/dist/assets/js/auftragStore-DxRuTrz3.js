import{a6 as d}from"./vendor-utils-DTv3oRQQ.js";import{e as i,c as A}from"./index-BXi_OX1m.js";import{a as c}from"./auftragService-DS9683K3.js";const a=A("AuftragStore"),b=d()(i((g,n)=>({semesterAuftraege:{},isLoading:!1,lastUpdate:null,loadAuftraege:async e=>{a.debug(" Loading auftraege for semester:",e),g({isLoading:!0});try{const r=await c.getAuftraegeFuerSemester(e);g(t=>({semesterAuftraege:{...t.semesterAuftraege,[e]:r},isLoading:!1,lastUpdate:Date.now()})),a.debug(" ✓ Loaded",r.length,"auftraege")}catch(r){a.error(" ✗ Error loading auftraege:",r),g({isLoading:!1})}},addAuftrag:(e,r)=>{a.debug(" Adding auftrag:",r.id),g(t=>{const u=t.semesterAuftraege[e]||[];return{semesterAuftraege:{...t.semesterAuftraege,[e]:[...u,r]},lastUpdate:Date.now()}})},updateAuftrag:(e,r,t)=>{a.debug(" Updating auftrag:",r,t),g(u=>{const o=(u.semesterAuftraege[e]||[]).map(s=>s.id===r?{...s,...t}:s);return{semesterAuftraege:{...u.semesterAuftraege,[e]:o},lastUpdate:Date.now()}})},removeAuftrag:(e,r)=>{a.debug(" Removing auftrag:",r),g(t=>{const f=(t.semesterAuftraege[e]||[]).filter(o=>o.id!==r);return{semesterAuftraege:{...t.semesterAuftraege,[e]:f},lastUpdate:Date.now()}})},clearAuftraege:e=>{a.debug(" Clearing auftraege for semester:",e),g(r=>{const t={...r.semesterAuftraege};return delete t[e],{semesterAuftraege:t,lastUpdate:Date.now()}})},triggerRefresh:async e=>{a.debug(" ⟳ Triggering refresh for semester:",e),await n().loadAuftraege(e)}}),{name:"AuftragStore"}));export{b as u};
