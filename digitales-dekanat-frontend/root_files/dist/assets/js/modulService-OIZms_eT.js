import{a as n,c as g,h as d}from"./index-ChymPdOX.js";const o=g("ModulService"),u={},l=5*60*1e3;function c(s){const r=u[s];return r&&Date.now()-r.timestamp<l?r.data:null}function i(s,r){s==="lehrformen"?u.lehrformen={data:r,timestamp:Date.now()}:s==="dozenten"?u.dozenten={data:r,timestamp:Date.now()}:s==="studiengaenge"&&(u.studiengaenge={data:r,timestamp:Date.now()})}class h{async getAllModule(){try{return(await n.get("/module/")).data.data||[]}catch(r){return o.error("Error fetching modules:",r),[]}}async getAllModules(r){try{o.debug("Fetching modules with params:",r);const e=new URLSearchParams;r?.po_id&&e.append("po_id",r.po_id.toString()),r?.turnus&&e.append("turnus",r.turnus),r?.search&&e.append("search",r.search),r?.page&&e.append("page",r.page.toString()),r?.per_page&&e.append("per_page",r.per_page.toString());const t=`/module/${e.toString()?`?${e}`:""}`;o.debug("Request URL:",t);const a=await n.get(t);return o.debug("Response:",{success:a.data.success,dataLength:a.data.data?.length||0}),a.data}catch(e){throw o.error("Error fetching modules:",e),new Error(d(e))}}async getModulDetails(r){try{o.debug("Fetching details for module:",r);const e=await n.get(`/module/${r}`);return o.debug("Module details received"),e.data}catch(e){throw o.error("Error fetching module details:",e),new Error(d(e))}}async getModulDozenten(r,e){try{o.debug("Fetching dozenten for module:",r);const t=e?`/module/${r}/dozenten?rolle=${e}`:`/module/${r}/dozenten`,a=await n.get(t);return o.debug("Dozenten received:",a.data.data?.length||0),a.data}catch(t){throw o.error("Error fetching dozenten:",t),new Error(d(t))}}async getModulLehrformen(r){try{o.debug("Fetching lehrformen for module:",r);const e=await n.get(`/module/${r}/lehrformen`);return o.debug("Lehrformen received:",e.data.data?.length||0),e.data}catch(e){throw o.error("Error fetching lehrformen:",e),new Error(d(e))}}async searchModules(r,e){try{o.debug("Searching modules with query:",r);const t=new URLSearchParams({q:r});e&&t.append("po_id",e.toString());const a=await n.get(`/module/search?${t}`);return o.debug("Search results:",a.data.data?.length||0),a.data}catch(t){throw o.error("Error searching modules:",t),new Error(d(t))}}async getStatistik(r){try{o.debug("Fetching statistics");const e=r?`/module/statistik?po_id=${r}`:"/module/statistik",t=await n.get(e);return o.debug("Statistics received"),t.data}catch(e){throw o.error("Error fetching statistics:",e),new Error(d(e))}}async createModule(r){try{o.debug("Creating module:",r.kuerzel);const e=await n.post("/module/",r);return o.debug("Module created:",e.data.data?.id),e.data}catch(e){throw o.error("Error creating module:",e),new Error(d(e))}}async updateModule(r,e){try{o.debug("Updating module:",r);const t=await n.put(`/module/${r}`,e);return o.debug("Module updated"),t.data}catch(t){throw o.error("Error updating module:",t),new Error(d(t))}}async deleteModule(r,e=!1){try{o.debug("Deleting module:",r,"force:",e);const t=await n.delete(`/module/${r}?force=${e}`);return o.debug("Module deleted"),t.data}catch(t){throw o.error("Error deleting module:",t),new Error(d(t))}}async addLehrform(r,e){try{o.debug("Adding lehrform to module:",r);const t=await n.post(`/module/${r}/lehrformen`,e);return o.debug("Lehrform added"),t.data}catch(t){throw o.error("Error adding lehrform:",t),new Error(d(t))}}async updateLehrform(r,e,t){try{o.debug("Updating lehrform:",e);const a=await n.put(`/module/${r}/lehrformen/${e}`,{sws:t});return o.debug("Lehrform updated"),a.data}catch(a){throw o.error("Error updating lehrform:",a),new Error(d(a))}}async deleteLehrform(r,e){try{o.debug("Deleting lehrform:",e);const t=await n.delete(`/module/${r}/lehrformen/${e}`);return o.debug("Lehrform deleted"),t.data}catch(t){throw o.error("Error deleting lehrform:",t),new Error(d(t))}}async addDozent(r,e){try{o.debug("Adding dozent to module:",r);const t=await n.post(`/module/${r}/dozenten`,e);return o.debug("Dozent added"),t.data}catch(t){throw o.error("Error adding dozent:",t),new Error(d(t))}}async updateDozent(r,e,t){try{o.debug("Updating dozent:",e);const a=await n.put(`/module/${r}/dozenten/${e}`,{rolle:t});return o.debug("Dozent updated"),a.data}catch(a){throw o.error("Error updating dozent:",a),new Error(d(a))}}async deleteDozent(r,e){try{o.debug("Deleting dozent:",e);const t=await n.delete(`/module/${r}/dozenten/${e}`);return o.debug("Dozent deleted"),t.data}catch(t){throw o.error("Error deleting dozent:",t),new Error(d(t))}}async updateDozentRolle(r,e,t){try{o.debug("Updating dozent rolle:",e,t);const a=await n.put(`/module/${r}/dozenten/${e}`,{rolle:t});return o.debug("Dozent rolle updated"),a.data}catch(a){throw o.error("Error updating dozent rolle:",a),new Error(d(a))}}async replaceDozent(r,e,t){try{o.debug("Replacing dozent:",e,"with",t);const a=await n.put(`/module/${r}/dozenten/${e}/replace`,{neuer_dozent_id:t});return o.debug("Dozent replaced"),a.data}catch(a){throw o.error("Error replacing dozent:",a),new Error(d(a))}}async addLiteratur(r,e){try{o.debug("Adding literatur to module:",r);const t=await n.post(`/module/${r}/literatur`,e);return o.debug("Literatur added"),t.data}catch(t){throw o.error("Error adding literatur:",t),new Error(d(t))}}async updateLiteratur(r,e,t){try{o.debug("Updating literatur:",e);const a=await n.put(`/module/${r}/literatur/${e}`,t);return o.debug("Literatur updated"),a.data}catch(a){throw o.error("Error updating literatur:",a),new Error(d(a))}}async deleteLiteratur(r,e){try{o.debug("Deleting literatur:",e);const t=await n.delete(`/module/${r}/literatur/${e}`);return o.debug("Literatur deleted"),t.data}catch(t){throw o.error("Error deleting literatur:",t),new Error(d(t))}}async updatePruefung(r,e){try{o.debug("Updating pruefung for module:",r);const t=await n.put(`/module/${r}/pruefung`,e);return o.debug("Pruefung updated"),t.data}catch(t){throw o.error("Error updating pruefung:",t),new Error(d(t))}}async updateLernergebnisse(r,e){try{o.debug("Updating lernergebnisse for module:",r);const t=await n.put(`/module/${r}/lernergebnisse`,e);return o.debug("Lernergebnisse updated"),t.data}catch(t){throw o.error("Error updating lernergebnisse:",t),new Error(d(t))}}async updateVoraussetzungen(r,e){try{o.debug("Updating voraussetzungen for module:",r);const t=await n.put(`/module/${r}/voraussetzungen`,e);return o.debug("Voraussetzungen updated"),t.data}catch(t){throw o.error("Error updating voraussetzungen:",t),new Error(d(t))}}async updateArbeitsaufwand(r,e){try{o.debug("Updating arbeitsaufwand for module:",r);const t=await n.put(`/module/${r}/arbeitsaufwand`,e);return o.debug("Arbeitsaufwand updated"),t.data}catch(t){throw o.error("Error updating arbeitsaufwand:",t),new Error(d(t))}}async getLehrformenOptions(){const r=c("lehrformen");if(r)return o.debug("Returning cached lehrformen"),{success:!0,data:r};try{const e=await n.get("/module/options/lehrformen");return e.data.success&&e.data.data&&i("lehrformen",e.data.data),e.data}catch(e){throw new Error(d(e))}}async getDozentenOptions(){const r=c("dozenten");if(r)return o.debug("Returning cached dozenten"),{success:!0,data:r};try{const e=await n.get("/module/options/dozenten");return e.data.success&&e.data.data&&i("dozenten",e.data.data),e.data}catch(e){throw new Error(d(e))}}async getStudiengaengeOptions(){const r=c("studiengaenge");if(r)return o.debug("Returning cached studiengaenge"),{success:!0,data:r};try{const e=await n.get("/module/options/studiengaenge");return e.data.success&&e.data.data&&i("studiengaenge",e.data.data),e.data}catch(e){throw new Error(d(e))}}clearOptionsCache(){u.lehrformen=void 0,u.dozenten=void 0,u.studiengaenge=void 0,o.debug("Options cache cleared")}}const w=new h;export{w as m};
